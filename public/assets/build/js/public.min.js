"use strict";function _typeof(o){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(o)}function AddonifyPerfectScrollBar(o){new PerfectScrollbar(o,{wheelSpeed:1,wheelPropagation:!0,minScrollbarLength:20,useBothWheelAxes:!0})}!function(_){_(document).ready(function(){var o,e,n=_("body"),d=(_("#addonify-compare-dock-thumbnails"),_("#addonify-compare-dock-message")),a=_("#addonify-compare-search-modal"),c=_("#addonify-compare-search-results"),r=_("#addonify-compare-modal"),t=_("#addonify-compare-modal-content"),i=_("#addonify-compare-modal-overlay"),s=_("#addonify-compare-search-modal-overlay"),l=_(".addonify-dock-compare-button"),m=addonifyCompareProductsJSObject.localDataExpiresIn,p="addonify_compare_products_plugin",f=C().length;function u(){0===f?n.removeClass("addonify-compare-dock-is-visible"):n.addClass("addonify-compare-dock-is-visible")}function y(){1<f?l.show():l.hide()}function b(){f<2?(d.removeClass("addonify-compare-hidden"),_("#addonify-compare-dock-inner").removeClass("full")):(d.addClass("addonify-compare-hidden"),_("#addonify-compare-dock-inner").addClass("full"))}function h(){f<2?(_("#addonify-compare-products-notice").removeClass("addonify-compare-hidden"),_("#addonify-compare-products-table").hide()):_("#addonify-compare-products-notice").addClass("addonify-compare-hidden")}function v(){c.html(""),_("#addonify-compare-search-query").val(""),n.removeClass("addonify-compare-disable-scroll"),a.addClass("addonify-compare-hidden"),s.addClass("addonify-compare-hidden")}function C(){return g("product_ids")}function S(o){var e,d;e="product_ids","object"===_typeof(o=o)&&(o=JSON.stringify(o)),(d=new Date).setTime(d.getTime()+24*m*60*60*1e3),d=d.getTime(),localStorage.setItem(p+"_"+e,o),localStorage.setItem(p+"_deadline",d)}function g(o){var e,d,a=localStorage.getItem(p+"_deadline");if(null!==a){if((new Date).getTime()<parseInt(a))return null!==(e=function(o){var e;try{e=JSON.parse(o)}catch(o){return!1}return e}(localStorage.getItem(p+"_"+o)))&&"object"===_typeof(e)&&(d=new Array,0<(a=Object.keys(e)).length&&a.forEach(function(o){d[o]=e[o]}),d);localStorage.removeItem(p+"_"+o),localStorage.removeItem(p+"_deadline")}return[]}(e=g("product_ids"))instanceof Array&&0<e.length&&_.ajax({url:addonifyCompareProductsJSObject.ajaxURL,type:"POST",data:{action:addonifyCompareProductsJSObject.actionInit,product_ids:JSON.stringify(e),nonce:addonifyCompareProductsJSObject.nonce},success:function(o){t.html(o.compareModalContent),_.each(o.html,function(o,e){_(o).replaceWith(e)}),e.forEach(function(o){_(".addonify-cp-button[data-product_id="+o+"]").addClass("selected")}),o=o.compareModalContent,0<n.has("#addonify-compare-products-comparison-table-on-page").length&&_("#addonify-compare-products-comparison-table-on-page").html(o),b(),y(),0!=Number(f)?n.addClass("addonify-compare-dock-is-visible"):n.removeClass("addonify-compare-dock-is-visible")}}),n.on("click",".addonify-cp-button, #addonify-compare-search-results .item-add",function(o){o.preventDefault();var e=_(this),d=e.data("product_id"),a=C();a instanceof Array&&-1<a.indexOf(d)?console.log("Product already exists in compare list."):(a.push(d),_.ajax({url:addonifyCompareProductsJSObject.ajaxURL,type:"POST",data:{action:addonifyCompareProductsJSObject.actionAddProduct,product_id:d,product_ids:JSON.stringify(a),nonce:addonifyCompareProductsJSObject.nonce},success:function(o){o.success&&(t.html(o.compareModalContent),S(a),f+=1,e.addClass("selected").attr("disabled","disabled"),e.hasClass("item-add")&&v(),_("#addonify-compare-dock-thumbnails").append(o.product_image),_('.addonify-compare-dock-thumbnail[data-product_id="'+d+'"]').append(o.product_image).removeClass("loading"),h(),u(),y(),b())}}))}),n.on("click",".addonify-compare-dock-remove-item-btn, .addonify-remove-compare-products",function(o){o.preventDefault();var o=_(this),e=o.data("product_id"),d=C(),a=d.indexOf(e);-1===a?console.log("Product does not exist in compare list."):(d.splice(a,1),S(d),f-=1,_("#addonify-compare-products-table tbody ").find("td[data-product_id="+e+"]").remove(),o.hasClass("addonify-compare-table-remove-btn")&&(_('td[data-product_id="'+e+'"]').remove(),_('button.addonify-cp-button[data-product_id="'+e+'"]').removeClass("selected").removeAttr("disabled"),f<2&&(n.removeClass("addonify-compare-disable-scroll"),i.addClass("addonify-compare-hidden"),r.addClass("addonify-compare-hidden"))),o.hasClass("addonify-compare-docker-remove-button")&&(_('button.addonify-cp-button[data-product_id="'+e+'"]').removeClass("selected").removeAttr("disabled"),_('.addonify-compare-dock-components[data-product_id="'+e+'"]').remove()),_('.addonify-compare-dock-components[data-product_id="'+e+'"]')&&_('.addonify-compare-dock-components[data-product_id="'+e+'"]').remove(),h(),u(),y(),b())}),n.on("click","#addonify-compare-dock-compare-btn",function(o){o.preventDefault(),n.addClass("addonify-compare-disable-scroll"),i.removeClass("addonify-compare-hidden"),n.removeClass("addonify-compare-dock-is-visible"),r.removeClass("addonify-compare-hidden"),t.addClass("loading");g("product_ids")}),n.on("click","#addonify-compare-dock-add-item",function(){n.addClass("addonify-compare-disable-scroll"),n.removeClass("addonify-compare-dock-is-visible"),s.removeClass("addonify-compare-hidden"),a.removeClass("addonify-compare-hidden"),_("#addonify-compare-search-query").focus()}),n.on("click","#addonify-compare-search-close-button, #addonify-compare-search-modal-overlay",function(){n.removeClass("addonify-compare-disable-scroll"),n.addClass("addonify-compare-dock-is-visible"),v()}),n.on("keyup","#addonify-compare-search-query",function(){var d=_(this).val();clearTimeout(o),o=setTimeout(function(){var o,e;(o=d).length&&(_("#addonify-compare-search-results").html("").addClass("loading"),e=C(),o={action:addonifyCompareProductsJSObject.actionSearchProducts,query:o,nonce:addonifyCompareProductsJSObject.nonce,product_ids:JSON.stringify(e)},_.post(addonifyCompareProductsJSObject.ajaxURL,o,function(o){_("#addonify-compare-search-results").removeClass("loading").html(o)}))},500)}),n.on("click","#addonify-compare-close-button, #addonify-compare-modal-overlay",function(){n.removeClass("addonify-compare-disable-scroll"),i.addClass("addonify-compare-hidden"),u(),r.addClass("addonify-compare-hidden"),n.removeClass("addonify-compare-modal-is-visible")})})}(jQuery),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".addonify-compare-scrollbar").forEach(function(o){null!=o&&AddonifyPerfectScrollBar(o)})});