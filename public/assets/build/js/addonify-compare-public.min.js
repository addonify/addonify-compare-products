!function(S){"use strict";S(document).ready(function(){var a,d=S("body"),e=[],n=S("#addonify-footer-thumbnails"),o=S("#addonify-compare-footer-message"),i=S("#addonify-compare-search-modal"),t=S("#addonify-compare-search-results"),c=S("#addonify-compare-modal"),r=S("#addonify-compare-modal-content"),s=S("#addonify-footer-compare-btn"),f=!1,l=!1,p=!0,m=addonify_compare_ajax_object.display_type,u=addonify_compare_ajax_object.comparision_page_url,_=S("#addonify-compare-modal-overlay"),y=S("#addonify-compare-search-modal-overlay");function h(){1<e.length?s.fadeIn():s.fadeOut()}function b(){e.length?d.addClass("addonify-compare-footer-is-visible"):d.removeClass("addonify-compare-footer-is-visible")}function v(o){var a;o.length&&(a={action:addonify_compare_ajax_object.action_get_thumbnails,ids:o},S.getJSON(addonify_compare_ajax_object.ajax_url,a,function(o){S.each(o,function(o,a){S('.addonify-footer-thumbnail[data-product_id="'+o+'"]').append('<img src="'+a+'">').removeClass("loading")})}))}function j(o){var a=o.split(","),d="";a.forEach(function(o){d+='<div class="addonify-footer-components" data-product_id="'+o+'"><div class="sortable addonify-footer-thumbnail loading" data-product_id="'+o+'"><span class="addonify-footer-remove addonify-footer-btn" data-product_id="'+o+'"></span></div></div>'}),n.append(d)}function C(){e.length<2?o.removeClass("addonify-compare-hidden"):o.addClass("addonify-compare-hidden")}function g(){i.addClass("addonify-compare-hidden"),t.html(""),S("#addonify-compare-search-query").val("")}function x(){var o;_.removeClass("addonify-compare-hidden"),d.removeClass("addonify-compare-footer-is-visible"),f&&r.html(""),l=!0,c.removeClass("addonify-compare-hidden"),r.addClass("loading"),e.join(",")&&f&&(o={action:addonify_compare_ajax_object.action_get_compare_contents},S.get(addonify_compare_ajax_object.ajax_url,o,function(o){r.removeClass("loading").html(o)}))}function k(){_.addClass("addonify-compare-hidden"),d.addClass("addonify-compare-footer-is-visible"),c.addClass("addonify-compare-hidden"),f=l=!1}function w(o){o=o.join(","),"browser"==addonify_compare_ajax_object.cookie_expire?Cookies.set("addonify_compare_product_selected_product_ids",o,{path:addonify_compare_ajax_object.cookie_path,domain:addonify_compare_ajax_object.cookie_domain}):Cookies.set("addonify_compare_product_selected_product_ids",o,{path:addonify_compare_ajax_object.cookie_path,domain:addonify_compare_ajax_object.cookie_domain,expires:parseInt(addonify_compare_ajax_object.cookie_expire)})}S("#addonify-footer-thumbnails").sortable({stop:function(){e=[],n.find(".addonify-footer-components").each(function(){e.push(S(this).data("product_id"))}),f=!0,w(e),l&&(k(),f=!0,x())}}).disableSelection(),S("#addonify-compare-products-footer-bar a, button.addonify-cp-button").click(function(o){o.preventDefault()}),function(){{var o;(function(){var a="addonify-overlay-btn-wrapper",d="addonify-overlay-btn",o=S("."+a),e=S(".addonify-overlay-buttons");{var n;o.length?e.each(function(){var o=S("button."+d,this).clone();S("button."+d,this).remove(),S("."+a,this).append(o)}):(e.each(function(){S("button."+d,this).wrapAll('<div class=" '+a+' " />')}),n=S("img.attachment-woocommerce_thumbnail").height(),S("."+a).css("height",n+"px"),S("."+a).hover(function(){S(this).css("opacity",1)},function(){S(this).css("opacity",0)}))}})(),function(){var o=Cookies.get("addonify_compare_product_selected_product_ids");if(!o)return;e=S.map(o.split(","),function(o){return parseInt(o)})}(),h(),e.length&&(function(o){o.split(",").forEach(function(o){S('button.addonify-cp-button[data-product_id="'+o+'"]').addClass("selected").attr("disabled",!0)})}(o=e.join(",")),j(o),v(o),b())}C()}(),d.on("click","button.addonify-cp-button, #addonify-compare-search-results .item-add",function(o){o.preventDefault();var a=S(this).data("product_id");a&&(g(),e.includes(a)?f=!1:(S(this).attr("disabled",!0),f=!0,e.push(a),w(e),S(this).addClass("selected"),i.addClass("addonify-compare-hidden"),j(a.toString()),v(a.toString()),d.addClass("addonify-compare-footer-is-visible"),C()),b(),h(),p=p&&!(f=!0))}),d.on("click",".addonify-footer-remove",function(o){o.preventDefault();var a=S(this).data("product_id");if(a){f=!0,S('button.addonify-cp-button[data-product_id="'+a+'"]').removeClass("selected").removeAttr("disabled");for(var d=0;d<e.length;d++)e[d]==a&&e.splice(d,1);w(e),S('.addonify-footer-components[data-product_id="'+a+'"]').remove(),b(),h(),C(),l&&(k(),f=!0,x())}}),d.on("click","#addonify-footer-add",function(){d.removeClass("addonify-compare-footer-is-visible"),y.removeClass("addonify-compare-hidden"),i.removeClass("addonify-compare-hidden")}),d.on("click","#addonify-compare-search-close-button, #addonify-compare-search-modal-overlay",function(){d.addClass("addonify-compare-footer-is-visible"),y.addClass("addonify-compare-hidden"),g()}),d.on("keyup","#addonify-compare-search-query",function(){var o=S(this).val();clearTimeout(a),a=setTimeout(function(){!function(o){if(!o.length)return;t.html("").addClass("loading");var a={action:addonify_compare_ajax_object.action_search_items,query:o,nonce:addonify_compare_ajax_object.nonce};S.post(addonify_compare_ajax_object.ajax_url,a,function(o){t.removeClass("loading").html(o)})}(o)},500)}),d.on("click","#addonify-footer-compare-btn",function(){"page"!=m?l?k():(p=p&&!(f=!0),x()):window.location.href=u}),d.on("click","#addonify-compare-close-button, #addonify-compare-modal-overlay",function(){k()})})}(jQuery);